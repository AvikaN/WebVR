 <script src="https://aframe.io/releases/0.2.0/aframe.min.js"></script>
 <script src="perlin.js"></script> 
 <script> 
    var AMOUNTX= 20, AMOUNTY = 20,  SEPARATION = 100, count = 0;
    var YDISPLACE = -300; 
    var angle = 0.0;
    var angleVel = 0.003;
    var startAngle = 0;
    noise.seed(Math.random());
    var MAX = 920, MIN = -1000 
    //build a mesh object that contains all the spheres
    AFRAME.registerComponent('blanket', {
        init: function(){
            this.circles = [];
            for( var ix = 0; ix < AMOUNTX; ix++ ){
              for( var iy = 0; iy < AMOUNTY; iy++ ){
                 var entity = document.createElement('a-sphere');
                 var position = new THREE.Vector3();
                 position.x =  ix * SEPARATION - ( ( AMOUNTX * SEPARATION ) / 2 );
                 position.z =  iy * SEPARATION - ( ( AMOUNTY * SEPARATION ) / 2 ); 
                 position.y = YDISPLACE;

                 //color 
                 var colorx = parseInt(map_range(position.x , MIN, MAX, 0 , 255));
                 var colorz = parseInt(map_range(position.y, MIN, MAX, 0, 255));
                 entity.setAttribute("position", position);
                 entity.setAttribute("radius", "3");
                 var color = "rgb(" + colorx + "," + colorz + ", 140)";
                 entity.setAttribute("color", color);

                 this.el.sceneEl.appendChild(entity);
                 this.circles.push(entity);
              }
            }
        }, 
        tick: function(){
            startAngle+=0.02;
            angle = startAngle;
            var i = 0;
            //console.log(c.getAttribute('position'));
            for ( var ix = 0; ix < AMOUNTX; ix ++ ) {
              for ( var iy = 0; iy < AMOUNTY; iy ++ ) {
                   var particle = this.circles[i];
                   var pos = particle.getAttribute("position");
                   var y = noise.perlin2(angle + count ,angle);
                   var final_y = map_range(y, -1 , 1, -300, -100)
                   var newPos = new THREE.Vector3();
                   newPos.x = pos.x, newPos.y = final_y, newPos.z = pos.z; 
                   this.circles[i].setAttribute("position", newPos);
                   i++; 
                   angle+=angleVel;
              }
            } 
            count += 0.01;
        }
    }); 
    function map_range(value, low1, high1, low2, high2) {
        return low2 + (high2 - low2) * (value - low1) / (high1 - low1);
    }
 </script> 

 <a-scene>
     <a-sky color="black"> </a-sky> 
     <!-- ~~ lights --> 
     <a-light type="point" color="white" position="-5 0 0"></a-light>
     <a-entity blanket> </a-entity> 
     <a-camera position="0 0 0"> </a-camera> 
 </a-scene> 